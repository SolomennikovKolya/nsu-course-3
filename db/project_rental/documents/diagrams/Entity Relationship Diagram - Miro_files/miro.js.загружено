"use strict";(()=>{var S=Object.defineProperty;var o=(n,e)=>S(n,"name",{value:e,configurable:!0});var g=class g extends Error{constructor(e){super(e),this.name="SdkMethodExecutionError"}};o(g,"SdkMethodExecutionError");var d=g;var u=class u extends Error{constructor(e,r){super(e),this.name="SdkConnectionError",r instanceof Error&&(this.stack=`${this.stack}
Caused by: ${r.stack}`)}};o(u,"SdkConnectionError");var i=u;var w=new Promise(()=>{});function y(n,e,r){let t,c=n.then(s=>(t=r?s[r]:s,t)).catch(s=>{if(s instanceof i)return w;throw s});return{path:e,realAsyncTarget:c,get realSyncedTarget(){return t},proxyTarget:s=>{let p=n.then(a=>{let m=typeof a=="function"?a()[r](...s):a[r](...s);return m&&typeof m.then=="function"?()=>m:m}).catch(a=>{if(a instanceof i)return w;throw new d(`Cannot call the method ".${r}()" at path "${e.join(".")}".
  - ${a.message}`)});return l(y(p,e))}}}o(y,"createSegment");function l(n){return new Proxy(n.proxyTarget,{get:(e,r)=>l(y(n.realAsyncTarget,[...n.path,r],r)),apply:(e,r,t)=>{let c=n.realSyncedTarget;return c?c(...t):e(t)}})}o(l,"createProxyLevel");function T(n){return l(y(n,[]))}o(T,"createLazyObjectProxy");var k=(()=>{let n={createScriptURL:e=>e};try{return window.trustedTypes?.createPolicy("miro-importer",{createScriptURL:e=>e})??n}catch{return n}})();function h(n){return new Promise((e,r)=>{let t=document.createElement("script");t.src=k.createScriptURL(n),t.onload=e,t.onerror=r,document.head.appendChild(t)})}o(h,"loadScript");var P="SDK_REQUEST_VERSION";async function x(n){let e=Math.random().toString(36).slice(-10);return Promise.race([new Promise((r,t)=>setTimeout(()=>t(new i("SDK version fetching timeout")),1e4)),new Promise((r,t)=>{let c=o(s=>{let a=s.data?.payload?.find(({id:m})=>m===e)?.payload?.sdk;a&&r(new URL(a)),t(new i("SDK version can't be received")),window.removeEventListener("message",c)},"handleMessage");window.addEventListener("message",c),window.parent.postMessage({commandId:"sdkv2-plugin-message",payload:[{id:e,name:P,payload:{sdkVariant:n}}],msgId:e},"*")})])}o(x,"requestMiroVersion");async function M(){let n=new URL(document.location.href);try{let e=n.searchParams.get("_sdk"),r=await x(e);return await h(r.href),window.miro}catch(e){throw new i("Miro SDK is not connected. Ensure your app is running within the Miro environment.",e)}}o(M,"loadMiroSDK");var f=M();window.miro=T(f);f.catch(n=>console.error(n));})();
